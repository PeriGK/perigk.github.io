
  
<!doctype html>
<html class="no-js" lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="author" content="Periklis Gkolias">
    <meta name="description" content="Bitperi - productivity tips and coding for thriving people, Periklis Gkolias">
    <meta name="keywords" content="blog,personal,responsive,search,font awesome,pages,posts,multilingual,highlight.js,syntax highlighting,premium,shortcuts">
    <meta name="generator" content="Hugo 0.74.2" />
    <title>
        
           
               Doctests, the shy giant of testing modules &vert; Bitperi(Periklis Gkolias)
           
        
    </title>
    <meta name="description" content="Doctests, the shy giant of testing modules - Bitperi - productivity tips and coding for thriving people, Periklis Gkolias">
    <meta itemprop="name" content="Doctests, the shy giant of testing modules">
    <meta itemprop="description" content="Doctests, the shy giant of testing modules - Bitperi - productivity tips and coding for thriving people, Periklis Gkolias">
    <meta property="og:title" content="Doctests, the shy giant of testing modules">
    <meta property="og:description" content="Doctests, the shy giant of testing modules - Bitperi - productivity tips and coding for thriving people, Periklis Gkolias">
    <meta property="og:image" content="https://www.gravatar.com/avatar/d41d8cd98f00b204e9800998ecf8427e?size=200">
    <meta property="og:url" content="https://perigk.github.io/posts/doctests-the/">
    <meta property="og:site_name" content="Bitperi(Periklis Gkolias)">
    <meta property="og:type" content="article">

    


    
    <link href="/posts/doctests-the/" rel="alternate" type="application/rss+xml" title="Bitperi(Periklis Gkolias)" />
    <link href="/posts/doctests-the/" rel="feed" type="application/rss+xml" title="Bitperi(Periklis Gkolias)" />
    

    

    <link rel="stylesheet" href="https://perigk.github.io/theme.css">

    

    
    
    
</head>

<body class="bilberry-hugo-theme">

    
    <nav>

    <div class="container">
        <ul class="topnav">
            
        </ul>

        
        <div id="search-box" class="search">
            <i class="fas fa-search"></i>
            <input id="search" type="text" placeholder="Search ...">
        </div>
        
    </div>
</nav>


    
<header>

    <div class="container">
        <div class="logo">
            <a id="siteBaseUrl" href="/" class="logo">
                
                <img src="/avatars/myAvatar.svg" alt="">
                

                <span class="overlay"><i class="fa fa-home"></i></span>
            </a>
        </div>
        <div class="titles">
            <h3 class="title"><a
                    href="/">Bitperi(Periklis Gkolias)</a></h3>
            
            <span class="subtitle">Productivity tips and coding for thriving people</span>
            
        </div>

        

        
            <div class="toggler">
                
                <i class="fa fa-bars" aria-hidden="true"></i>
            </div>
        </div>
</header>


    <div class="main container">
        
     
    <div class="article-wrapper u-cf single">
        
            <a class="bubble" href="https://perigk.github.io/posts/doctests-the/">
    <i class="fas fa-fw fa-pencil-alt"></i>
</a>

<article class="default article">
    

    <div class="content">
    <h1 class="article-title"><a href="https://perigk.github.io/posts/doctests-the/">Doctests, the shy giant of testing modules</a></h1>
    <div class="meta">
        
        
        <span class="date moment">2018-05-29</span>
        
        

        

        

        
        <span class="author">
            
            
            <a href="https://perigk.github.io/author/periklis-gkolias/">Periklis Gkolias</a>
            
        </span>
        
    </div>

    
    <p><img src="/img/2018/05/2b5wg8.jpg" alt="2b5wg8"></p>
<p>Do you use python, even to wash your clothes? Do you find unit testing boring, but still have to do it, because you find value in automated testing? Then this article is for you.</p>
<h1 id="the-idea">The idea</h1>
<p>I believe you have used the python console, from time to time. Lets assume you are writing a few inline functions like below, to experiment with stuff:</p>
<pre><code>$ python
Python 3.6.4 |Anaconda custom (64-bit)| (default, Jan 16 2018, 18:10:19) 
[GCC 7.2.0] on linux
Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.
&gt;&gt;&gt; def addme(a):
...     return a + a
... 
&gt;&gt;&gt; addme(2)
4
&gt;&gt;&gt; addme(1.9)
3.8
&gt;&gt;&gt; addme(0)
0
&gt;&gt;&gt; 

</code></pre><p>So, you have written an inline function, and you have made a couple test runs on it, to do some basic verifications. What if python could read the above output and do the reasoning for you, at runtime? That&rsquo;s the idea behind doctests, my friend.</p>
<h1 id="seriously">Seriously?</h1>
<p><img src="/img/2018/05/1_9UAvMlcfo2ZROWRPa3HODA.jpg" alt="2b5x49"></p>
<p>Totally, python has introduced a lot of intuitive and&hellip;heartbreaking features from time to time, which are now mainstream to a few main languages. Why not this one too?</p>
<h1 id="benefits-of-doctests">Benefits of doctests</h1>
<p>The benefits are quite a few and not limited to:</p>
<ul>
<li>They are ridiculously easy to write. I mean, you can even outsource it to your younger cousin, who studies about the anatomy of soil atoms, because he owes you, for fixing his computer.</li>
<li>Unless you find copy paste difficult, they are more joyful to write. This time you have to familiar with a terminal environment, though.</li>
<li>There is no need to open another file(even though you can put all doctests of your app to a single file) to read the test code for any function, as they lie right under the signature of each function.</li>
<li>They are executable with the doctest module and readable without knowing a bit of python.</li>
</ul>
<h1 id="what-about-unit-tests">What about unit tests?</h1>
<p>Unit tests, still offer great value and advanced capabilities of testing. While doctests are great on validating simple and pure functions, they are not very good, when you have to do complex validation. For example, if a sequence of commands was called during the test.</p>
<h1 id="what-about-mocking">What about mocking?</h1>
<p>Doctests can handle mocking gracefully, with a great library called <a href="https://pypi.org/project/MiniMock/">Minimock</a>. I encourage you, to give it a try and let me know your thoughts.</p>
<p>Even though I like the initiative, I prefer my tests to have separate roles. I don&rsquo;t want my doctests to be heavily loaded and one-size-fits-them-all. But that&rsquo;s really a matter of taste, there is nothing wrong if you disagree and I am more than happy to hear your rationale , if so.</p>
<h1 id="a-working-example">A working example</h1>
<p>Talk is cheap, so let&rsquo;s write some code. Below is a working example, using the function of the prompt above.</p>
<pre><code>def addme(a):
    &quot;&quot;&quot;
    This is a docstring, usually to explain the use of a function. Please do not confuse it with doctests. They both mean to provide forms of documentation, but doctests are executable too.
    &gt;&gt;&gt; addme(4)
    8
    &gt;&gt;&gt; addme('a')
    'aa'
    &gt;&gt;&gt; addme(set())
    Traceback (most recent call last):
        ...
    TypeError: unsupported operand type(s) for +: 'set' and 'set'
    &quot;&quot;&quot;
    return a + a

if __name__ == '__main__':
    import doctest
    doctest.testmod()
    print(addme(1))
</code></pre><p>There are a couple of points, worth noticing here:</p>
<ul>
<li>The doctests, need to live inside a docstring. In there, just &lsquo;copy-paste&rsquo; the output of your python console quick tests.</li>
<li>If you need to simulate an exception case, you only need to add the first and the last lines of the exception message. Did you expect to hardcode paths or do any weird logic to get the file&rsquo;s full path and print it in full? C&rsquo;mon, python wont do that :)</li>
<li>You need the doctest library to run the tests. Nose doesn&rsquo;t need it though.</li>
<li>You can run the above, as usual, with <code>python mydoctests.py</code></li>
</ul>
<h1 id="i-need-my-tests-to-run-as-part-of-cicdct-cycle-whats-in-for-me">I need my tests to run as part of CI/CD/CT cycle. What&rsquo;s in for me?</h1>
<p>I am not here to disappoint you, am I ? :)</p>
<p>The <a href="http://nose.readthedocs.io/en/latest/">nose</a> test runner, supports running all your doctests additionally to your unit tests. Just add the flag <code>--with-doctest</code> and you are good to go.</p>
<h1 id="nice-stuff-where-to-go-from-here">Nice stuff, where to go from here?</h1>
<ul>
<li>Read the python <a href="https://docs.python.org/3.6/library/doctest.html">documentation</a> for more twitches and cases.</li>
<li>Read this fantastic <a href="https://amzn.to/2sjvKoP">book</a> and especially chapter 4, which covers doctests.</li>
<li>Check implementations of other languages. For example, the one for <a href="https://github.com/davidchambers/doctest">NodeJS</a></li>
<li><a href="http://nose.readthedocs.io/en/latest/plugins/doctests.html">Doctests and nose</a></li>
</ul>
<h1 id="conclusion">Conclusion</h1>
<p>Thank you for reading this article, I hope you enjoyed it and that the article triggered your interest in writing more and less painful tests. Please spread the love, with the buttons below, if so. Feel free to add your own thoughts and experiences with doctests too.</p>

    
</div>

    
<div class="footer">


    
        <div class="tags">
            <i class="fa fa-tags"></i>
            <div class="links">
                
                    
                    
                    <a href="https://perigk.github.io/tags/doctests/">doctests</a>
                    
                
                    
                    
                    <a href="https://perigk.github.io/tags/python3/">python3</a>
                    
                
                    
                    
                    <a href="https://perigk.github.io/tags/django/">django</a>
                    
                
                    
                    
                    <a href="https://perigk.github.io/tags/python/">python</a>
                    
                
                    
                    
                    <a href="https://perigk.github.io/tags/automated-testing/">automated-testing</a>
                    
                
            </div>
        </div>
    

    
</div>

</article>

        
    </div>

    
        <div id="comments-container">
            <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "bilberry-hugo-theme" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
            

        </div>
    

     

    </div>

    
<footer>
    <div class="container">

        
        <div class="recent-posts">
            <strong>Latest posts</strong>
            <ul>
                
                <li>
                    <a href="https://perigk.github.io/post/git-bisect-the-undervalued-debugging-machine-gun/">Git Bisect, the Undervalued Debugging Machine Gun</a>
                </li>
                
                <li>
                    <a href="https://perigk.github.io/posts/the-fastest-track-to-psm-i/">How to get certified as a professional scrum master, the fast and the slow way</a>
                </li>
                
                <li>
                    <a href="https://perigk.github.io/posts/ways-to-keep-up-with-the-software-trends/">12 Ways to Keep Up With the Software Trends</a>
                </li>
                
                <li>
                    <a href="https://perigk.github.io/posts/30-tips-for-software-engineering-careers-30-years-of-life/">30 Tips for Software Engineering Careers, After 30 Years of Life</a>
                </li>
                
                <li>
                    <a href="https://perigk.github.io/posts/a-primer-on-partial-functions/">A Primer on Python Partial Functions</a>
                </li>
                
                <li>
                    <a href="https://perigk.github.io/posts/podcasts-why-do-you-have-to-suck/">Oh Podcasts, Why Do You Have to Suck</a>
                </li>
                
                <li>
                    <a href="https://perigk.github.io/posts/generate-cooking-recipes/">Generate cooking recipes that guarantee food poisoning, with LSTM based libraries</a>
                </li>
                
            </ul>
        </div>
        

        
        <div class="categories">
            <a href="/categories/"><strong>Categories</strong></a>
            <ul>
                
                <li>
                    <a href="/categories/programming">Programming
                        (7)</a>
                </li>
                
                <li>
                    <a href="/categories/python3">Python3
                        (4)</a>
                </li>
                
                <li>
                    <a href="/categories/productivity">Productivity
                        (3)</a>
                </li>
                
                <li>
                    <a href="/categories/solo-dev">Solo dev
                        (3)</a>
                </li>
                
                <li>
                    <a href="/categories/career">Career
                        (2)</a>
                </li>
                
                <li>
                    <a href="/categories/code-quality">Code quality
                        (2)</a>
                </li>
                
                <li>
                    <a href="/categories/debugging">Debugging
                        (2)</a>
                </li>
                
            </ul>
        </div>
        

        <div class="right">
            
            <div class="external-profiles">
                <strong>Social media</strong>

                
            </div>
            

            
        </div>
    </div>
</footer>


<div class="credits">
    <div class="container">
        <div class="copyright">
            <a href="https://github.com/Lednerb" target="_blank">
                &copy;
                
                2017
                
                by Lednerb
            </a>
            
        </div>
        <div class="author">
            <a href="https://github.com/Lednerb/bilberry-hugo-theme"
                target="_blank">Bilberry Hugo Theme</a>
        </div>
    </div>
</div>


    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-33576432-2', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>


    


    <script type="text/javascript" src="https://perigk.github.io/theme.js"></script>

    
    
    

    
    <div id="activate-algolia-search" class="hidden">
  <input type="hidden" id="algolia-search-appId" value="Y2C4RWMPXW">
  <input type="hidden" id="algolia-search-apiKey" value="50ea7f8c41c0ad233926e0be2b769ed1">
  <input type="hidden" id="algolia-search-indexName" value="default-content">
  <input type="hidden" id="algolia-search-noSearchResults" value="Nothing found.">

  
  <input type="hidden" id="algolia-search-currentLanguageOnly">
  
</div>

    


</body>

</html>
